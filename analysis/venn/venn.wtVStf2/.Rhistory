class = c("high.rated", "not.high.rated")))
fisher.test(ratings.budget.matrix)
knit(Rcourse2013.rmd)
library(knitr)
knit(Rcourse2013.rmd)
knit("Rcourse2013.rmd")
install.packages("swirl")
library(swirl)
swirl()
5+7
x <-5+7
x
y <- x+3
y <- x - 3
y
c(1.1, 9, 3.14)
z <- c(1.1, 9, 3.14)
?c
z
z + 555 +z
c(z, 555, z)
z * 2 + 100
mySqrt <- sqrt(z)
info()
mySqrt <- sqrt(z - 1)
mySqrt
myDiv <- z/mysqrt
myDiv <- z/mySqrt
myDiv
c(1,2,3,4) + c(0,10)
c(1, 2, 3, 4) + c(0, 10, 100)
1:20
pi:10
15:1
?:
?':'
ls
?':'
?`:`
seq(1, | 20)
seq(1, 20)
seq(0, 10, by=0.5)
my_seq <- seq(5, 10, length = 30)
length(my_seq)
1:length(my_seq)
seq(along = my_seq)
seq_along(myseq)
seq_along(my_seq)
rep(0, times = 40)
rep(c(0, 1, 2), times = 10)
rep(c(0, 1, 2), each = 10)
swirl()
library(seqinr)
install.packages(seqinr)
install.packages(seqinr)
install.packages("seqinr")
seqinr
?seqinr
??seqinr
install.packages("scholar")
install.packages("scholar")
library(scholar)
library(Reol)
install.packages("Reol")
library(Reol)
FirstTwo("Galanthus peshmenii A.P.Davis & C.D.Brickell")
source("http://bioconductor.org/biocLite.R")
biocLite("Biostrings")
library(Biostrings)
itagSeqs <- read.DNAStringSet("../SlCDS_ITAG2.3_pseudoGMAP5V61passNoDif.fa")
itagSeqs <- read.DNAStringSet("../Users/iamciera/Dropbox/Research/LCMProject/04RNAseqAnalysis/BWA/ITAG2.4_cds.fasta")
itagSeqs <- read.DNAStringSet("/Users/iamciera/Dropbox/Research/LCMProject/04RNAseqAnalysis/BWA/ITAG2.4_cds.fasta")
itagSeqs <- DNAStringSet("/Users/iamciera/Dropbox/Research/LCMProject/04RNAseqAnalysis/BWA/ITAG2.4_cds.fasta")
itagSeqs <- read.DNAStringSet("/Users/iamciera/Dropbox/Research/LCMProject/04RNAseqAnalysis/BWA/ITAG2.4_cds.fasta")
itagSeqs <- read.DNAStringSet(/Users/iamciera/Dropbox/Research/LCMProject/04RNAseqAnalysis/BWA/ITAG2.4_cds.fasta, "fasta")
itagSeqs <- read.DNAStringSet(Users/iamciera/Dropbox/Research/LCMProject/04RNAseqAnalysis/BWA/ITAG2.4_cds.fasta, "fasta")
itagSeqs <- read.DNAStringSet(ITAG2.4_cds.fasta, "fasta")
itagSeqs <- read.FASTA("ITAG2.4_cds.fasta")
library(Biostrings)
?readFASTA
??readFASTA
itagSeqs <- read.FASTA("ITAG2.4_cds.fasta")
itagSeqs <- read.fasta(file = system.file("ITAG2.4_cds.fasta", package = "seqinr")
d
itagSeqs <- read.fasta(file = system.file("ITAG2.4_cds.fasta", package = "seqinr"))
library(Biostrings)
itagSeqs <- read.FASTA("ITAG2.4_cds.fasta")
itagSeqs <- read.DNAStringSet("ITAG2.4_cds.fasta")
source("http://bioconductor.org/biocLite.R")
biocLite()
biocLite("GenomicRanges")
biocLite("GenomicRanges")
library(IRanges)
rng <- IRanges(start=4, end=13)
rng
IRanges(start=4, width=3)
IRanges(end=5, width=5)
IRanges(end=5, width=6)
IRanges(end=5, width=7)
x <- IRanges(start=c(4, 7, 2, 20), end=c(13, 7, 5, 23))
x
names(x) <- letters[1:4]
x
class(x)
str(x)
end(x) <- end(x) + 2
x <- IRanges(start=c(40, 80), end=c(67, 114))
x + 4L
x
x + 4
y <- IRanges(start=c(4, 6, 10, 12), width=13)
y
restrict(y, 5, 10)
alns <- IRanges(start=sample(seq_len(50), 20), width=5)
alns
head(alns, 4)
head(alns, 4)
setwd("~/Dropbox/diffGeneExp/analysis/2014.6.23_analysis.wtVStf2/tf2cother_wtcother")
library(edgeR)
library(yaml)
counts <- read.delim("../requisiteData/sam2countsResults.tsv",row.names=1)
head(counts)
colnames(counts)
counts[is.na(counts)] <- 0
countstf2 <- counts[,grep(tf2, colnames(counts), value = TRUE)]
countstf2 <- counts[,grep("tf2", colnames(counts), value = TRUE)]
countswt <- counts[,grep("wt", colnames(counts), value = TRUE)]
countstf2
counts <- cnind(countstf2, countswt)
counts <- cbind(countstf2, countswt)
group <- c(rep(tf2, 6), rep(tf2, 6))
group <- c(rep("tf2", 6), rep("wt", 6))
group
d <- DGEList(counts = counts, group = group)
counts
head(counts)
setwd("~/Dropbox/diffGeneExp/analysis/venn.wtVStf2")
setwd("~/Dropbox/diffGeneExp/analysis/venn/venn.wtVStf2")
annotation1<- read.delim("../../requisiteData/ITAG2.3_all_Arabidopsis_ITAG_annotations.tsv", header=FALSE)
colnames(annotation1) <- c("ITAG", "SGN_annotation")
annotation2<- read.delim ("../../requisiteData/ITAG2.3_all_Arabidopsis_annotated.tsv")
annotation <- merge(annotation1,annotation2, by = "ITAG")
aRegionWt <- read.table("../../wtambr_wtaother/wtambr_wtaother_DE_sig")
aRegionWt <- read.table("../../wtambr_wtaother/wtambr_wtaother_DE_sig.txt")
setwd("~/Dropbox/diffGeneExp/analysis/venn/venn.wtVStf2")
aRegionWt <- read.table("../../DE/wtambr_wtaother/wtambr_wtaother_DE_sig.txt")
aRegionTf2 <- read.table("../../DE/tf2ambr_tf2aother/tf2ambr_tf2ambr_DE_sig.txt")
aRegionTf2 <- read.table("../../DE/tf2ambr_tf2aother/tf2ambr_tf2aother_DE_sig.txt")
aRegionWt <- read.table("../../DE/wtambr_wtaother/wtambr_wtaother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
aRegionTf2 <- read.table("../../DE/tf2ambr_tf2aother/tf2ambr_tf2aother_DE_sig.txt", header = TRUE, fill = TRUE)
aRegionWt$logFC <- as.numeric(as.character(aRegionWt$logFC))
colnames(aRegionWt)[1] <- "itag"
colnames(aRegionTf2)[1] <- "itag"
aRegionTf2$logFC <- as.numeric(as.character(aRegionTf2$logFC))
colnames(aRegionTf2)[1] <- "itag"
aRegionTf2Up <- subset(aRegionTf2, logFC > 0)
aRegionTf2Down <- subset(aRegionTf2, logFC < 0)
aRegionWtUp <- subset(aRegionWt, logFC > 0)
aRegionWtDown <- subset(aRegionWt, logFC < 0)
dir.create("all") #Creates directory to put all out tables.
aRegionWt <- read.table("../../DE/wtambr_wtaother/wtambr_wtaother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
aRegionTf2 <- read.table("../../DE/tf2ambr_tf2aother/tf2ambr_tf2aother_DE_sig.txt", header = TRUE, fill = TRUE)
colnames(aRegionWt)
ABall <- matrix(intersect(aRegionWt$ITAG, aRegionTf2$ITAG))
colnames(ABall) <- c("ITAG")
aRegionAll <- matrix(intersect(aRegionWt$ITAG, aRegionTf2$ITAG))
colnames(aRegionAll) <- c("ITAG")
aRegionAll <- matrix(intersect(aRegionWt$ITAG, aRegionTf2$ITAG))
colnames(aRegionAll) <- c("ITAG")
write.csv(aRegionAll, file = "all/aRegionAll.annotated.csv") #write .csv file
aRegionAll.annotated <- merge(aRegionAll, annotation, by = "ITAG", by.x = TRUE) #Merge with annotated
write.csv(aRegionAll.annotated, file = "all/aRegionAll.annotated.csv") #write .csv file
aRegionAll.annotated <- merge(aRegionAll, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionAll.annotated, file = "all/aRegionAll.annotated.csv") #write .csv file
length(aRegionWt$ITAG)
length(aRegionTf2$ITAG)
cross.area = length(aRegionAll$ITAG)
colnames(aRegionAll) <- c("ITAG")
length(aRegionAll$ITAG)
aRegionAll <- matrix(intersect(aRegionWt$ITAG, aRegionTf2$ITAG))
length(aRegionAll$ITAG)
cross.area = length(aRegionAll)
length(aRegionAll)
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll)
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3,
lty      = "blank",
cex      = 2,
cat.cex  = 2)
grid.draw(venn.plot)
render("vennDiagram.tf2.Rmd", "pdf_document")
library(rmarkdown)
library(VennDiagram)
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll)
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3,
lty      = "blank",
cex      = 2,
cat.cex  = 2)
grid.draw(venn.plot)
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll)
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll)
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll)
category = c("wt", "tf2"))
aRegionAll <- matrix(intersect(aRegionWt$ITAG, aRegionTf2$ITAG))
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll),
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll),
scaled = FALSE
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
cross.area = length(aRegionAll),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
grid.draw(venn.plot)
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWt$ITAG),
area2    = length(aRegionTf2$ITAG),
grid.newpage()
grid.newpage()
grid.newpage()
grid.draw(venn.plot)
onlyAall <- matrix(setdiff(aRegionWt$ITAG, aRegionTf2$ITAG))
aRegionWtOnly <- matrix(setdiff(aRegionWt$ITAG, aRegionTf2$ITAG))
colnames(aRegionWtOnly) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionWtOnly.annotated, file = "all/aRegionWtOnly.annotated.csv") #write .csv file
aRegionTf2Only <- matrix(setdiff(aRegionTf2$ITAG, aRegionWt$ITAG))
colnames(aRegionTf2Only) <- c("ITAG")
colnames(aRegionWtOnly) <- c("ITAG")
colnames(aRegionTf2Only) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
aRegionTf2Only.annotated <- merge(aRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionTf2Only.annotated, file = "all/aRegionTf2Only.annotated.csv") #write .csv file
write.csv(aRegionWtOnly.annotated, file = "all/aRegionWtOnly.annotated.csv") #write .csv file
aRegionup <- matrix(intersect(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
dir.create("up") #Creates directory to put up out tables.
aRegionup <- matrix(intersect(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
aRegionup <- matrix(intersect(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
aRegionWtUp$ITAG
aRegionWtUp <- subset(aRegionWt, logFC > 0)
aRegionWtDown <- subset(aRegionWt, logFC < 0)
aRegionTf2Up <- subset(aRegionTf2, logFC > 0)
aRegionTf2Down <- subset(aRegionTf2, logFC < 0)
aRegionup <- matrix(intersect(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
colnames(aRegionup) <- c("ITAG")
aRegionup.annotated <- merge(aRegionup, annotation, by = "ITAG", by.x = TRUE, up.x = TRUE) #Merge with annotated
write.csv(aRegionup.annotated, file = "up/aRegionup.annotated.csv") #write .csv file
grid.newpage()
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWtUp$ITAG),
area2    = length(aRegionTf2Up$ITAG),
cross.area = length(aRegionup),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
aRegionWtOnly <- matrix(setdiff(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
aRegionTf2Only <- matrix(setdiff(aRegionTf2Up$ITAG, aRegionWtUp$ITAG))
colnames(aRegionWtOnly) <- c("ITAG")
colnames(aRegionTf2Only) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
aRegionTf2Only.annotated <- merge(aRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionTf2Only.annotated, file = "up/aRegionTf2Only.annotated.csv") #write .csv file
write.csv(aRegionWtOnly.annotated, file = "up/aRegionWtOnly.annotated.csv") #write .csv file
aRegionDown.annotated <- merge(aRegionDown, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
dir.create("up") #Creates directory to put up out tables.
#up
aRegionup <- matrix(intersect(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
colnames(aRegionup) <- c("ITAG")
aRegionup.annotated <- merge(aRegionup, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionup.annotated, file = "up/aRegionup.annotated.csv") #write .csv file
#Makes the grid
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWtUp$ITAG),
area2    = length(aRegionTf2Up$ITAG),
cross.area = length(aRegionup),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
#Get only genes specific to wt
aRegionWtOnly <- matrix(setdiff(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
aRegionTf2Only <- matrix(setdiff(aRegionTf2Up$ITAG, aRegionWtUp$ITAG))
colnames(aRegionWtOnly) <- c("ITAG")
colnames(aRegionTf2Only) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
aRegionTf2Only.annotated <- merge(aRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionTf2Only.annotated, file = "up/aRegionTf2Only.annotated.csv") #write .csv file
write.csv(aRegionWtOnly.annotated, file = "up/aRegionWtOnly.annotated.csv") #write .csv file
dir.create("up") #Creates directory to put up out tables.
aRegionup <- matrix(intersect(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
colnames(aRegionup) <- c("ITAG")
aRegionup.annotated <- merge(aRegionup, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionup.annotated, file = "up/aRegionup.annotated.csv") #write .csv file
#Makes the grid
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWtUp$ITAG),
area2    = length(aRegionTf2Up$ITAG),
cross.area = length(aRegionup),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
aRegionWtOnly <- matrix(setdiff(aRegionWtUp$ITAG, aRegionTf2Up$ITAG))
aRegionTf2Only <- matrix(setdiff(aRegionTf2Up$ITAG, aRegionWtUp$ITAG))
colnames(aRegionWtOnly) <- c("ITAG")
colnames(aRegionTf2Only) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
aRegionTf2Only.annotated <- merge(aRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionTf2Only.annotated, file = "up/aRegionTf2Only.annotated.csv") #write .csv file
write.csv(aRegionWtOnly.annotated, file = "up/aRegionWtOnly.annotated.csv") #write .csv file
aRegionDown <- matrix(intersect(aRegionWtDown$ITAG, aRegionTf2Down$ITAG))
colnames(aRegionDown) <- c("ITAG")
aRegionDown.annotated <- merge(aRegionDown, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionDown.annotated, file = "down/aRegionDown.annotated.csv") #write .csv file
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWtDown$ITAG),
area2    = length(aRegionTf2Down$ITAG),
cross.area = length(aRegionDown),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
aRegionWtOnly <- matrix(setdiff(aRegionWtDown$ITAG, aRegionTf2Down$ITAG))
aRegionTf2Only <- matrix(setdiff(aRegionTf2Down$ITAG, aRegionWtDown$ITAG))
colnames(aRegionWtOnly) <- c("ITAG")
colnames(aRegionTf2Only) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
aRegionTf2Only.annotated <- merge(aRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionTf2Only.annotated, file = "down/aRegionTf2Only.annotated.csv") #write .csv file
write.csv(aRegionWtOnly.annotated, file = "down/aRegionWtOnly.annotated.csv") #write .csv file
dir.create("down") #Creates directory to put Down out tables.
#Down
aRegionDown <- matrix(intersect(aRegionWtDown$ITAG, aRegionTf2Down$ITAG))
colnames(aRegionDown) <- c("ITAG")
aRegionDown.annotated <- merge(aRegionDown, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionDown.annotated, file = "down/aRegionDown.annotated.csv") #write .csv file
#Makes the grid
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(aRegionWtDown$ITAG),
area2    = length(aRegionTf2Down$ITAG),
cross.area = length(aRegionDown),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
#Get only genes specific to wt
aRegionWtOnly <- matrix(setdiff(aRegionWtDown$ITAG, aRegionTf2Down$ITAG))
aRegionTf2Only <- matrix(setdiff(aRegionTf2Down$ITAG, aRegionWtDown$ITAG))
colnames(aRegionWtOnly) <- c("ITAG")
colnames(aRegionTf2Only) <- c("ITAG")
aRegionWtOnly.annotated <- merge(aRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
aRegionTf2Only.annotated <- merge(aRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(aRegionTf2Only.annotated, file = "down/aRegionTf2Only.annotated.csv") #write .csv file
write.csv(aRegionWtOnly.annotated, file = "down/aRegionWtOnly.annotated.csv") #write .csv file
write.csv(aRegionAll.annotated, file = "aRegion/all/aRegionAll.annotated.csv") #write .csv file
aRegionWt <- read.table("../../DE/wtbmbr_wtbother/wtbmbr_wtbother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
aRegionTf2 <- read.table("../../DE/tf2bmbr_tf2bother/tf2bmbr_tf2bother_DE_sig.txt", header = TRUE, fill = TRUE)
bRegionWt <- read.table("../../DE/wtbmbr_wtbother/wtbmbr_wtbother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
bRegionTf2 <- read.table("../../DE/tf2bmbr_tf2bother/tf2bmbr_tf2bother_DE_sig.txt", header = TRUE, fill = TRUE)
bRegionWt <- read.table("../../DE/wtbmbr_wtbother/wtbmbr_wtbother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
bRegionTf2 <- read.table("../../DE/tf2bmbr_tf2bother/tf2bmbr_tf2bother_DE_sig.txt", header = TRUE, fill = TRUE)
bRegionWt$logFC <- as.numeric(as.character(bRegionWt$logFC))
bRegionTf2$logFC <- as.numeric(as.character(bRegionTf2$logFC))
bRegionTf2Up <- subset(bRegionTf2, logFC > 0)
bRegionTf2Down <- subset(bRegionTf2, logFC < 0)
bRegionWtUp <- subset(bRegionWt, logFC > 0)
bRegionWtDown <- subset(bRegionWt, logFC < 0)
dir.create("bRegion/all") #Creates directory to put all out tables.
dir.create("bRegion/all") #Creates directory to put all out tables.
#all
bRegionAll <- matrix(intersect(bRegionWt$ITAG, bRegionTf2$ITAG))
colnames(bRegionAll) <- c("ITAG")
bRegionAll.annotated <- merge(bRegionAll, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(bRegionAll.annotated, file = "bRegion/all/bRegionAll.annotated.csv") #write .csv file
#Makes the grid
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(bRegionWt$ITAG),
area2    = length(bRegionTf2$ITAG),
cross.area = length(bRegionAll),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
#Get only genes specific to wt
bRegionWtOnly <- matrix(setdiff(bRegionWt$ITAG, bRegionTf2$ITAG))
bRegionTf2Only <- matrix(setdiff(bRegionTf2$ITAG, bRegionWt$ITAG))
colnames(bRegionWtOnly) <- c("ITAG")
colnames(bRegionTf2Only) <- c("ITAG")
bRegionWtOnly.annotated <- merge(bRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
bRegionTf2Only.annotated <- merge(bRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(bRegionTf2Only.annotated, file = "bRegion/all/bRegionTf2Only.annotated.csv") #write .csv file
write.csv(bRegionWtOnly.annotated, file = "bRegion/all/bRegionWtOnly.annotated.csv") #write .csv file
```
##UP Regulation Genes
This takes up significant gene  up-regulated.
```{r}
dir.create("bRegion/up") #Creates directory to put up out tables.
#up
bRegionup <- matrix(intersect(bRegionWtUp$ITAG, bRegionTf2Up$ITAG))
colnames(bRegionup) <- c("ITAG")
bRegionup.annotated <- merge(bRegionup, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(bRegionup.annotated, file = "bRegion/up/bRegionup.annotated.csv") #write .csv file
#Makes the grid
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(bRegionWtUp$ITAG),
area2    = length(bRegionTf2Up$ITAG),
cross.area = length(bRegionup),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
#Get only genes specific to wt
bRegionWtOnly <- matrix(setdiff(bRegionWtUp$ITAG, bRegionTf2Up$ITAG))
bRegionTf2Only <- matrix(setdiff(bRegionTf2Up$ITAG, bRegionWtUp$ITAG))
colnames(bRegionWtOnly) <- c("ITAG")
colnames(bRegionTf2Only) <- c("ITAG")
bRegionWtOnly.annotated <- merge(bRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
bRegionTf2Only.annotated <- merge(bRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(bRegionTf2Only.annotated, file = "bRegion/up/bRegionTf2Only.annotated.csv") #write .csv file
write.csv(bRegionWtOnly.annotated, file = "bRegion/up/bRegionWtOnly.annotated.csv") #write .csv file
```
##Down Regulated Genes
Down regulated genes means significantly down regulated.
```{r}
dir.create("bRegion/down") #Creates directory to put Down out tables.
#Down
bRegionDown <- matrix(intersect(bRegionWtDown$ITAG, bRegionTf2Down$ITAG))
colnames(bRegionDown) <- c("ITAG")
bRegionDown.annotated <- merge(bRegionDown, annotation, by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(bRegionDown.annotated, file = "bRegion/down/bRegionDown.annotated.csv") #write .csv file
#Makes the grid
grid.newpage()
venn.plot <- draw.pairwise.venn(area1    = length(bRegionWtDown$ITAG),
area2    = length(bRegionTf2Down$ITAG),
cross.area = length(bRegionDown),
scaled = FALSE,
category = c("wt", "tf2"),
fill     = c("blue", "red"),
alpha    = 0.3)
grid.draw(venn.plot)
#Get only genes specific to wt
bRegionWtOnly <- matrix(setdiff(bRegionWtDown$ITAG, bRegionTf2Down$ITAG))
bRegionTf2Only <- matrix(setdiff(bRegionTf2Down$ITAG, bRegionWtDown$ITAG))
colnames(bRegionWtOnly) <- c("ITAG")
colnames(bRegionTf2Only) <- c("ITAG")
bRegionWtOnly.annotated <- merge(bRegionWtOnly, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
bRegionTf2Only.annotated <- merge(bRegionTf2Only, annotation,by = "ITAG", by.x = TRUE, all.x = TRUE) #Merge with annotated
write.csv(bRegionTf2Only.annotated, file = "bRegion/down/bRegionTf2Only.annotated.csv") #write .csv file
write.csv(bRegionWtOnly.annotated, file = "bRegion/down/bRegionWtOnly.annotated.csv") #write .csv file
```
bRegionWt <- read.table("../../DE/wtcmbr_wtcother/wtbmbr_wtcother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
bRegionTf2 <- read.table("../../DE/tf2cmbr_tf2cother/tf2cmbr_tf2cother_DE_sig.txt", header = TRUE, fill = TRUE)
bRegionWt <- read.table("../../DE/wtcmbr_wtcother/wtcmbr_wtcother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
bRegionTf2 <- read.table("../../DE/tf2cmbr_tf2cother/tf2cmbr_tf2cother_DE_sig.txt", header = TRUE, fill = TRUE)
cRegionWt <- read.table("../../DE/wtcmbr_wtcother/wtcmbr_wtcother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
cRegionTf2 <- read.table("../../DE/tf2cmbr_tf2cother/tf2cmbr_tf2cother_DE_sig.txt", header = TRUE, fill = TRUE)
source('~/.active-rstudio-document', echo=TRUE)
render("vennDiagram.tf2.Rmd", "pdf_document")
render("vennDiagram.wtVStf2.Rmd", "pdf_document")
bRegionWt <- read.table("../../DE/wtcmbr_wtcother/wtcmbr_wtcother_DE_sig.txt", sep="", header = TRUE, fill = TRUE)
bRegionTf2 <- read.table("../../DE/tf2cmbr_tf2cother/tf2cmbr_tf2cother_DE_sig.txt", header = TRUE, fill = TRUE)
render("vennDiagram.wtVStf2.Rmd", "pdf_document")
