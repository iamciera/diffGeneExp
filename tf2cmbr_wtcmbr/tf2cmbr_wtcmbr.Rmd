WT vs *tf2*
----

*tf2* Marginal Blastozone C (base) vs Marginal Blastzone in C (base) region 
====================================================

```{r}
#INSTALL
biocLite()
library(edgeR)
source("http://bioconductor.org/biocLite.R")
biocLite("limma")
```

###Read in Data
Read in raw count data per gene.

```{r, results='hide'}
counts <- read.delim("../sam2countsResults.tsv",row.names=1)

#check the file
head(counts)
summary(counts)
colnames(counts)
#need to convert NA to 0 counts
counts[is.na(counts)] <- 0
```

###Subset per DE expirement

I am going to start by subsetting the particular treatments I am looking at. 

```{r}
colnames(counts)
tf2cmbrVSwtcmbr <- counts[,c(16:19,42:45)]
head(tf2cmbrVSwtcmbr)
colnames(tf2cmbrVSwtcmbr)
```

```{r}
group <- c(rep("tf2cmbr", 4), rep("wtcmbr", 4))
d <- DGEList(counts=tf2cmbrVSwtcmbr,group=group)
```

```{r}
d$samples
```

```{r}
cpm.d <- cpm(d)
d <- d[rowSums(cpm.d>5)>=3,] #change to 5
d <- estimateCommonDisp(d,verbose=T) 
d <- calcNormFactors(d)
d <- estimateCommonDisp(d)
DEtest <- exactTest(d,pair=c("tf2cmbr","wtcmbr"))
head(DEtest$table)

sum(DEtest$table$PValue<.05)
summary(decideTestsDGE(DEtest,p.value=.05))
sig.genes <- rownames(DEtest$table[DEtest$table$PValue<0.05,])
plotSmear(d,de.tags=sig.genes)
```

Subset by all the ones with a significant score

```{r}
results.sig <- subset(DEtest$table, DEtest$table$PValue < 0.05)
```

What are the genes that are misexpressed?
For this we need to add some annotation.

```{r, results="hide"}
annotation1<- read.delim("../ITAG2.3_all_Arabidopsis_ITAG_annotations.tsv", header=FALSE)  #Changed to the SGN human readable annotation
colnames(annotation1)<- c("ITAG", "SGN_annotation")
annotation2<- read.delim ("../ITAG2.3_all_Arabidopsis_annotated.tsv")
annotation <- merge(annotation1,annotation2, by =1,1, all.x=TRUE)
head(annotation, results='hide') 
results.annotated <- merge(results.sig,annotation,by.x="row.names",by.y="ITAG",all.x=T,sort=F)
```

#Write table with results

This is only the significant Genes.
```write.table(results.annotated,"tf2cmbr_wtcmbr_DE1.txt",sep="\t",row.names=F)```

#Write Full list

```{r}
results.annotated <- merge(DEtest$table,annotation,by.x="row.names",by.y="ITAG",all.x=T,sort=F) #merge
write.csv(results.annotated, "tf2cmbr_wtcmbr_DE1_full.csv", row.names=FALSE, na="") #write csv
```
